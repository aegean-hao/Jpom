(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{564:function(s,a,t){"use strict";t.r(a);var r=t(31),e=Object(r.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#前言"}},[s._v("前言")]),t("ul",[t("li",[t("a",{attrs:{href:"#问-升级到-2-9-x-为什么要特殊处理"}},[s._v("问：升级到 2.9.x 为什么要特殊处理？")])]),t("li",[t("a",{attrs:{href:"#问-该漏洞出现了一段时间-为什么现在才发修复版"}},[s._v("问：该漏洞出现了一段时间，为什么现在才发修复版？")])])])]),t("li",[t("a",{attrs:{href:"#升级流程总览"}},[s._v("升级流程总览")])]),t("li",[t("a",{attrs:{href:"#相关问题说明"}},[s._v("相关问题说明")]),t("ul",[t("li",[t("a",{attrs:{href:"#问-必须先升级到-2-8-24"}},[s._v("问：必须先升级到 2.8.24+？")])]),t("li",[t("a",{attrs:{href:"#问-如何查看备份记录中的备份文件路径"}},[s._v("问：如何查看备份记录中的备份文件路径？")])]),t("li",[t("a",{attrs:{href:"#问-执行-sh-xxxx-server-sh-restart-backup-h2-不生效该怎么办"}},[s._v("问：执行 sh /xxxx/Server.sh restart --backup-h2 不生效该怎么办？")])]),t("li",[t("a",{attrs:{href:"#问-官方是不是忘记还用-windows-用户啦"}},[s._v("问：官方是不是忘记还用 windows 用户啦？")])]),t("li",[t("a",{attrs:{href:"#问-不想通过管理脚本来操作-还有其他方法吗"}},[s._v("问：不想通过管理脚本来操作，还有其他方法吗？")])]),t("li",[t("a",{attrs:{href:"#问-容器安装的应该如何升级"}},[s._v("问：容器安装的应该如何升级？")])]),t("li",[t("a",{attrs:{href:"#问-升级服务端后需要将插件端也升级到-2-9-0-吗"}},[s._v("问：升级服务端后需要将插件端也升级到 2.9.0+ 吗？")])]),t("li",[t("a",{attrs:{href:"#问-哪里下载-2-8-24-安装包"}},[s._v("问：哪里下载 2.8.24+ 安装包？")])]),t("li",[t("a",{attrs:{href:"#问-插件端该如何升级到-2-9-0"}},[s._v("问：插件端该如何升级到 2.9.0+ ?")])])])])])]),t("p"),s._v(" "),t("h2",{attrs:{id:"前言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),t("h3",{attrs:{id:"问-升级到-2-9-x-为什么要特殊处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问-升级到-2-9-x-为什么要特殊处理"}},[s._v("#")]),s._v(" 问：升级到 2.9.x 为什么要特殊处理？")]),s._v(" "),t("p",[t("strong",[s._v("答")]),s._v(" ：因为 H2 在 "),t("code",[s._v("1.4.198, 2.0.202")]),s._v(" 版本间存在漏洞，漏洞编号为："),t("code",[s._v("CVE-2021-23463")]),s._v("，所以需要尽快升级到最新版本来避免该漏洞。\n但是 H2 的 1.4.x 升级到 2.0.x 是不兼容版本升级，不能直接无感升级。必须迁移旧数据到新版本中")]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"问-该漏洞出现了一段时间-为什么现在才发修复版"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问-该漏洞出现了一段时间-为什么现在才发修复版"}},[s._v("#")]),s._v(" 问：该漏洞出现了一段时间，为什么现在才发修复版？")]),s._v(" "),t("p",[t("strong",[s._v("答")]),s._v("：当我们看到漏洞相关消息就开始准备方案，我们刚开始想的方案是如何避免过多的人为操作，尽量自动化完成。\n结果我们尝试发现没有办法很好的避免（准备出一个界面化的操作），最后采用命令行方式操作。（此处自动🐶）")]),s._v(" "),t("h2",{attrs:{id:"升级流程总览"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#升级流程总览"}},[s._v("#")]),s._v(" 升级流程总览")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("需要先升级到 2.8.24+")]),s._v(" "),t("a",{attrs:{href:"https://gitee.com/dromara/Jpom/attach_files",target:"_blank",rel:"noopener noreferrer"}},[s._v("安装包下载地址"),t("OutboundLink")],1),s._v(" "),t("ol",[t("li",[s._v("升级方法有：在线升级、手动上传 jar 包等方式升级")])])]),s._v(" "),t("li",[s._v("检查 "),t("code",[s._v("Server.sh")]),s._v(" 脚本中 "),t("code",[s._v("ARGS")]),s._v(" 变量最后是否存在 "),t("code",[s._v("$@")]),s._v(" 字符\n"),t("ol",[t("li",[s._v("如果不存在则需要手动添加")]),s._v(" "),t("li",[t("code",[s._v("ARGS")]),s._v(" 变量完整示例："),t("code",[s._v('ARGS="--jpom.applicationTag=${Tag} --spring.profiles.active=pro --server.port=2122 --jpom.log=${Path}log $@"')])])])]),s._v(" "),t("li",[t("strong",[s._v("为了数据安全避免升级出现异常造成数据丢失，请手动备份一下 "),t("code",[s._v("db")]),s._v(" 目录")]),s._v(" "),t("ol",[t("li",[s._v("备份前一定要先关闭服务器程序，否则会出现数据库异常情况或者数据丢失等异常")]),s._v(" "),t("li",[s._v("关闭方式："),t("code",[s._v("sh /xxxx/Server.sh stop")])]),s._v(" "),t("li",[s._v("备份 db 目录方式："),t("code",[s._v("cp -r /xxxx/jpom-server/db /xxxx/jpom-server/db_backup")])])])]),s._v(" "),t("li",[s._v("通过命令行的方式创建数据备份\n"),t("ol",[t("li",[s._v("启动程序参数里面添加 --backup-h2")]),s._v(" "),t("li",[s._v("linux 环境举例："),t("code",[s._v("sh /xxxx/Server.sh restart --backup-h2")])]),s._v(" "),t("li",[s._v("当控制台输出 "),t("code",[s._v("Complete the backup database, save the path as /xxx/xxx/db/backup/xxxx.sql")]),s._v(" 字样表示备份成功")])])]),s._v(" "),t("li",[s._v("手动替换 jar\n"),t("ol",[t("li",[s._v("将 lib 目录下面的 "),t("code",[s._v("Server-2.8.x.jar")]),s._v(" 替换为最新的 "),t("code",[s._v("Server-2.9.x.jar")])]),s._v(" "),t("li",[s._v("注意可能需要修改 "),t("code",[s._v("Server.sh")]),s._v(" 脚本里面的 "),t("code",[s._v("RUNJAR")]),s._v(" 变量值为您上传新 jar 的文件名，如："),t("code",[s._v("Server-2.9.x.jar")])])])]),s._v(" "),t("li",[s._v("通过指定 sql 文件方式启动\n"),t("ol",[t("li",[s._v("启动程序参数里面添加 "),t("code",[s._v("--replace-import-h2-sql=/xxxx.sql --transform-sql")]),s._v(" (路径需要替换为第二步控制台输出的 sql 文件保存路径)")]),s._v(" "),t("li",[s._v("linux 环境举例："),t("code",[s._v("sh /xxxx/Server.sh restart --replace-import-h2-sql=/xxxx.sql --transform-sql")])])])]),s._v(" "),t("li",[s._v("观察控制输出内容\n"),t("ol",[t("li",[s._v("当控制台输出 "),t("code",[s._v("Import successfully according to sql,/xxx/xxx/db/backup/xxxx.sql")]),s._v(" 字样表示升级成功并自动启动程序")]),s._v(" "),t("li",[s._v("如果出现异常信息可以先尝试在搜索引擎搜索看看是否有解决办法")]),s._v(" "),t("li",[s._v("联系官方协助排查")])])]),s._v(" "),t("li",[t("strong",[s._v("补充步骤：")]),s._v(" "),t("code",[s._v("2.9.0")]),s._v(" 版本操作完成后基本功能使用正常，但是 SSH 相关功能会出现数据库异常（缺少字段）\n"),t("ol",[t("li",[s._v("需要重新初始化数据："),t("code",[s._v("sh /xxxx/Server.sh restart --rest:load_init_db")])]),s._v(" "),t("li",[s._v("执行这个操作需要使用 2.9.1+ 版本（2.9.0 存在问题，此处自动🐶）")])])]),s._v(" "),t("li",[s._v("愉快的使用 Jpom 2.9.x")])]),s._v(" "),t("h2",{attrs:{id:"相关问题说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#相关问题说明"}},[s._v("#")]),s._v(" 相关问题说明")]),s._v(" "),t("h3",{attrs:{id:"问-必须先升级到-2-8-24"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问-必须先升级到-2-8-24"}},[s._v("#")]),s._v(" 问：必须先升级到 2.8.24+？")]),s._v(" "),t("p",[t("strong",[s._v("答")]),s._v("：非必须，因为 2.8.24+ 新增了命令行方式备份数据，这样在程序未启动前就将所有数据备份导出为 sql 保证导出的数据是最新并且完整的。\n如果您不想升级到 2.8.24+ 再升级到 2.9.x 那么可以先用管理身份登录进入系统进入：【系统管理 -> 数据库备份】页面里面去创建一个全量备份记住备份文件完成路径")]),s._v(" "),t("p",[t("strong",[s._v("注意")]),s._v("："),t("code",[s._v("不通过命令行备份不能保证导出的备份数据一定是最新的奥，因为程序在运行中随时会产生新数据或者数据更新情况")])]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"问-如何查看备份记录中的备份文件路径"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问-如何查看备份记录中的备份文件路径"}},[s._v("#")]),s._v(" 问：如何查看备份记录中的备份文件路径？")]),s._v(" "),t("p",[t("strong",[s._v("答")]),s._v("：备份列表中状态列后面有一个复制按钮，点击一下就复制到粘贴板啦")]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"问-执行-sh-xxxx-server-sh-restart-backup-h2-不生效该怎么办"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问-执行-sh-xxxx-server-sh-restart-backup-h2-不生效该怎么办"}},[s._v("#")]),s._v(" 问：执行 "),t("code",[s._v("sh /xxxx/Server.sh restart --backup-h2")]),s._v(" 不生效该怎么办？")]),s._v(" "),t("p",[t("strong",[s._v("答")]),s._v("：如果你是从很早就使用了 Jpom 那么你现在管理服务端当脚本不是最新当，最新的管理脚本里面将执行命令的其他参数也传入了启动程序里面")]),s._v(" "),t("p",[s._v("解决办法有：")]),s._v(" "),t("ol",[t("li",[s._v("替换为最新的管理脚本文件 "),t("a",{attrs:{href:"https://gitee.com/dromara/Jpom/blob/master/modules/server/script/Server.sh",target:"_blank",rel:"noopener noreferrer"}},[s._v("Server.sh"),t("OutboundLink")],1)]),s._v(" "),t("li",[s._v("手动修改管理脚本，在脚本中 "),t("code",[s._v("ARGS")]),s._v(" 变量最后添加一个 "),t("code",[s._v("$@")]),s._v(" 即可\n"),t("ol",[t("li",[s._v("完整示例："),t("code",[s._v('ARGS="--jpom.applicationTag=${Tag} --spring.profiles.active=pro --server.port=2122 --jpom.log=${Path}log $@"')])])])])]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"问-官方是不是忘记还用-windows-用户啦"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问-官方是不是忘记还用-windows-用户啦"}},[s._v("#")]),s._v(" 问：官方是不是忘记还用 windows 用户啦？")]),s._v(" "),t("p",[t("strong",[s._v("答")]),s._v("：没有的，因为 linux 用户偏多，所以拿 linux 举例。windows 处理办法类似")]),s._v(" "),t("p",[s._v("可以按照 "),t("a",{attrs:{href:"https://gitee.com/dromara/Jpom/blob/master/modules/server/script/Server.bat",target:"_blank",rel:"noopener noreferrer"}},[s._v("Server.bat"),t("OutboundLink")],1),s._v(" 中 if 判断继续扩展")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" /p "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(" call:start\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2"')]),s._v(" call:stop\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v(" call:status\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"4"')]),s._v(" call:restart\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5"')]),s._v(" call:use\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6"')]),s._v(" call:restart --rest:ip_config\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7"')]),s._v(" call:restart --rest:load_init_db\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8"')]),s._v(" call:restart --rest:super_user_pwd\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(" EXIT\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("思路添加 IF,比如：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" /p "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(" call:start\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2"')]),s._v(" call:stop\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v(" call:status\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"4"')]),s._v(" call:restart\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5"')]),s._v(" call:use\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6"')]),s._v(" call:restart --rest:ip_config\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7"')]),s._v(" call:restart --rest:load_init_db\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8"')]),s._v(" call:restart --rest:super_user_pwd\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9"')]),s._v(" call:restart --backup-h2\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10"')]),s._v(" call:restart --replace-import-h2-sql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/xxxx.sql --transform-sql\nIF "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!ID!"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(" EXIT\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[t("code",[s._v("注意要修改 sql 路径")])]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"问-不想通过管理脚本来操作-还有其他方法吗"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问-不想通过管理脚本来操作-还有其他方法吗"}},[s._v("#")]),s._v(" 问：不想通过管理脚本来操作，还有其他方法吗？")]),s._v(" "),t("p",[t("strong",[s._v("答")]),s._v("：有")]),s._v(" "),t("ol",[t("li",[s._v("备份数据")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("java -jar server-2.8.24.jar --spring.profiles.active"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("pro --backup-h2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("导入数据")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("java -jar server-2.9.0.jar --spring.profiles.active"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("pro --replace-import-h2-sql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/xxxx.sql --transform-sql\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("更新管理脚本中的："),t("code",[s._v("RUNJAR")]),s._v(" 变量值为："),t("code",[s._v("server-2.9.0.jar")])])]),s._v(" "),t("p",[t("strong",[s._v("注意")]),s._v("：")]),s._v(" "),t("ol",[t("li",[s._v("通过次方式一定要在原目录操作")]),s._v(" "),t("li",[s._v("操作顺序一定是要先使用旧包备份数据，再通过新包导入数据")])]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"问-容器安装的应该如何升级"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问-容器安装的应该如何升级"}},[s._v("#")]),s._v(" 问：容器安装的应该如何升级？")]),s._v(" "),t("p",[t("strong",[s._v("答")]),s._v("：升级流程和 Linux 流程基本一致，需要注意的就是上传文件的方式需要先上传到宿主机，再通过 "),t("code",[s._v("docker cp")]),s._v(" 方式将文件复制到容器中。")]),s._v(" "),t("p",[s._v("下面以从 2.8.24 升级到 2.9.0 为例：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意：从 2.8.24 版本开始新增数据库备份的参数命令，建议先升级到 2.8.24")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备份低版本数据库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it jpom-server /bin/bash /usr/local/jpom-server/Server.sh restart --backup-h2\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行完后看到【Need to log out manually: Ctrl+C/Control+C】用 Ctrl + C 手动退出")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 替换脚本命令中为新版 Jar 包")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it jpom-server "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -r -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'/^RUNJAR="/s@.*@RUNJAR="Server-2.9.0.jar"@g\'')]),s._v(" /usr/local/jpom-server/Server.sh -i\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker cp 本地文件路径 容器ID/容器NAME:容器内路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /root/Server-2.9.0.jar jpom-server:/usr/local/jpom-server/lib/Server-2.9.0.jar\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器内部")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it jpom-server /bin/bash\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将低版本的数据库导入到新版本中")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("backupFile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -t /usr/local/jpom-server/data/db/backup/ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("head")]),s._v(" -1"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n/bin/bash /usr/local/jpom-server/Server.sh restart --replace-import-h2-sql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/jpom-server/data/db/backup/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$backupFile")]),s._v(" --transform-sql\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动完成后，输入 Ctrl + C 退出。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 退出容器，回到宿主机")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("h3",{attrs:{id:"问-升级服务端后需要将插件端也升级到-2-9-0-吗"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问-升级服务端后需要将插件端也升级到-2-9-0-吗"}},[s._v("#")]),s._v(" 问：升级服务端后需要将插件端也升级到 2.9.0+ 吗？")]),s._v(" "),t("p",[t("strong",[s._v("答")]),s._v("：我们建议服务端和插件端的版本一致，可以同步升级到 2.9.0。")]),s._v(" "),t("p",[s._v("只要您在使用过程中没有发现部分功能异常，无法使用，接口 404 等情况下，插件端不及时更新也是没有太多问题的。")]),s._v(" "),t("p",[s._v("插件端和服务端版本差异请尽量一致或者缩小，避免出现部分功能调整后关联影响。")]),s._v(" "),t("h3",{attrs:{id:"问-哪里下载-2-8-24-安装包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问-哪里下载-2-8-24-安装包"}},[s._v("#")]),s._v(" 问：哪里下载 2.8.24+ 安装包？")]),s._v(" "),t("p",[t("strong",[s._v("答")]),s._v("："),t("a",{attrs:{href:"https://gitee.com/dromara/Jpom/attach_files",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://gitee.com/dromara/Jpom/attach_files"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"问-插件端该如何升级到-2-9-0"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问-插件端该如何升级到-2-9-0"}},[s._v("#")]),s._v(" 问：插件端该如何升级到 2.9.0+ ?")]),s._v(" "),t("p",[t("strong",[s._v("答")]),s._v("：插件端还是可以使用以前的方式：手动上传 jar，在线升级等。推荐使用在线升级，可以在服务端页面批量升级插件端版本")])])}),[],!1,null,null,null);a.default=e.exports}}]);