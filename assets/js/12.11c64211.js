(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{507:function(s,a,t){"use strict";t.r(a);var r=t(31),e=Object(r.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"jpom使用nginx代理推荐配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jpom使用nginx代理推荐配置"}},[s._v("#")]),s._v(" Jpom使用Nginx代理推荐配置")]),s._v(" "),t("h3",{attrs:{id:"http-相关配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#http-相关配置"}},[s._v("#")]),s._v(" Http 相关配置")]),s._v(" "),t("div",{staticClass:"language-log line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-log"}},[t("code",[s._v("server "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("#")]),s._v("charset koi8"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    access_log  "),t("span",{pre:!0,attrs:{class:"token file-path string"}},[s._v("/var/log/nginx/jpom.log")]),s._v(" main"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    listen       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    server_name  jpom"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xxxxxx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cn"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    \n    location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("{")]),s._v("\n        proxy_pass   "),t("span",{pre:!0,attrs:{class:"token url"}},[s._v("http://127.0.0.1:2122/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        proxy_set_header Host      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        proxy_set_header X"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Real"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("IP "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("remote_addr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        proxy_set_header X"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Forwarded"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("For "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("proxy_add_x_forwarded_for"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("#")]),s._v(" iframe 重定向\n        proxy_set_header X"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Forwarded"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Proto "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("scheme"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        proxy_set_header X"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Forwarded"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Port "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("server_port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("#")]),s._v(" 上传文件大小\n        client_max_body_size  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50000m")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        client_body_buffer_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("128k")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("#")]),s._v("  websocket 配置\n        proxy_set_header Upgrade "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("http_upgrade"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        proxy_set_header Connection "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"upgrade"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("#")]),s._v("  代理的二级路径配置 值填写nginx 中location的值  如 location "),t("span",{pre:!0,attrs:{class:"token file-path string"}},[s._v("/test-path/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("#")]),s._v("  proxy_set_header Jpom"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ProxyPath      "),t("span",{pre:!0,attrs:{class:"token file-path string"}},[s._v("/test-path/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("h3",{attrs:{id:"https-推荐配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#https-推荐配置"}},[s._v("#")]),s._v(" Https 推荐配置")]),s._v(" "),t("div",{staticClass:"language-log line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-log"}},[t("code",[s._v("server "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("{")]),s._v("\n    listen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    server_name jpom"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xxxxxx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cn"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    access_log  "),t("span",{pre:!0,attrs:{class:"token file-path string"}},[s._v("/var/log/nginx/jpom.log")]),s._v(" main"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    ssl on"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    ssl_certificate   "),t("span",{pre:!0,attrs:{class:"token file-path string"}},[s._v("/etc/nginx/ssl/jpom-xxxxxx.pem")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    ssl_certificate_key  "),t("span",{pre:!0,attrs:{class:"token file-path string"}},[s._v("/etc/nginx/ssl/jpom-xxxxxx.key")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    ssl_session_timeout "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5m")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    ssl_ciphers ECDHE"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("RSA"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("AES128"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("GCM"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("SHA256"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("ECDHE"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("ECDH"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("AES"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("HIGH"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("aNULL"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("MD5"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("ADH"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("RC4"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    ssl_protocols TLSv1 TLSv1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("1 TLSv1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("2"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    ssl_prefer_server_ciphers on"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    \n    location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("{")]),s._v("\n        proxy_pass   "),t("span",{pre:!0,attrs:{class:"token url"}},[s._v("http://127.0.0.1:2122/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("#")]),s._v(" 代理的二级路径配置 值填写nginx 中location的值  如 location "),t("span",{pre:!0,attrs:{class:"token file-path string"}},[s._v("/test-path/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("#")]),s._v(" proxy_set_header Jpom"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ProxyPath      "),t("span",{pre:!0,attrs:{class:"token file-path string"}},[s._v("/test-path/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        proxy_set_header Host      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        proxy_set_header X"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Real"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("IP "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("remote_addr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        proxy_set_header X"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Forwarded"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("For "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("proxy_add_x_forwarded_for"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("#")]),s._v(" iframe 重定向\n        proxy_set_header X"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Forwarded"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Proto "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("scheme"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        proxy_set_header X"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Forwarded"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Port "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("server_port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        client_max_body_size  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50000m")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        client_body_buffer_size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("128k")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("#")]),s._v("\twebsocket 配置\n        proxy_set_header Upgrade "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("http_upgrade"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n        proxy_set_header Connection "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"upgrade"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("}")]),s._v("\n\nserver "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("#")]),s._v("charset koi8"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    listen       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    server_name  jpom"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xxxxxx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cn"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n    rewrite "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("$")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token url"}},[s._v("https://$host$1")]),s._v(" permanent"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);